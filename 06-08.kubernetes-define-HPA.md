# 自定义指标HPA
> 1. Kubernetes中不仅支持CPU、内存为指标的HPA，还支持自定义指标的HPA，例如QPS。   
> 2. 本文中使用的yaml文件见manifests/HPA。

# 设置自定义指标
## kubernetes1.6
> **在kubernetes1.6集群中配置自定义指标的HPA的说明已废弃。**   
> 1. 在设置定义指标HPA之前需要先进行如下配置：   
>> 1. 将heapster的启动参数 --api-server 设置为 true   
>> 2. 启用custom metric API   
>> 3. 将kube-controller-manager的启动参数中--horizontal-pod-autoscaler-use-rest-clients设置为true，并指定--master为API server地址，如--master=http://172.20.0.113:8080   
>>
> 2. 在kubernetes1.5以前很容易设置，参考1.6以前版本的kubernetes中开启自定义HPA，而在1.6中因为取消了原来的annotation方式设置custom metric，只能通过API server和kube-aggregator来获取custom metric，因为只有两种方式来设置了，一是直接通过API server获取heapster的metrics，二是部署kube-aggragator来实现。   
> 3. 我们将在kubernetes1.8版本的kubernetes中，使用聚合的API server来实现自定义指标的HPA。

## kuberentes1.7+




